---
title: "useState vs useRef : 무엇을 사용해야 하는가?"
excerpt: "컴포넌트 내 변수로써의 ref와 state의 용도"

categories:
    - react
tags:
    - react

toc: true
toc_sticky: true
---

## ref는 단순히 DOM 요소를 가리키는 역할만 수행하지 않는다

우리는 흔히 `useRef`를 DOM 요소를 지정하는 데에만 사용한다. `ref`의 `current`라는 속성으로 요소의 값을 마치 변수처럼 사용하거나 조작할 수 있기 때문에, DOM 요소를 **값**처럼 사용할 수 있게 한다. 두 Hook은 용도가 전혀 달라 보이지만 `컴포넌트 내 변수`처럼 사용되는 공통점이 있어 차이를 정확히 알지 않으면 헷갈리기 쉽다. 어떤 경우에 `ref`을 사용하고, 어떤 경우에 `state`를 사용하고, 둘의 차이를 확실하게 알아보자.

## ref와 state는 무엇이 다른가

> ref는 state와 달리 값의 변화에 의한 `리렌더`가 일어나지 않는다.

- `state`는 컴포넌트의 생명 주기와 밀접한 관련이 있고, 상태가 변하면 렌더링되지만
- `ref`는 리렌더가 일어나지 않는다.

함수형 컴포넌트는 클래스 컴포넌트와는 달리, 인스턴스로 생성되지 않는다. 즉 컴포넌트 내의 고유한 값을 `this`를 사용하여 지정할 수 없다. 이 때 `useRef`를 사용하면 마치 this를 사용한 것처럼, **멤버변수** 구현이 가능하다. 렌더링과 관련이 없는 값이라면 `ref`쪽이 변수를 다루기에 더 편할 수 있다. 그런데, 그렇다면 일반 변수/상수를 선언하지 않고 굳이 `ref`로 객체를 만들어야 하는 이유는 무엇일까?

## ref를 컴포넌트 내 변수로 사용할 수 있다

useRef는 일반적인 자바스크립트 객체이며, heap 영역에 저장된다. 그래서 어플리케이션이 종료되거나 가비지 컬렉팅 될 때까지 참조할 때마다 같은 메모리 주소를 읽게 되고 값이 바뀌어도 리렌더링 되지 않는다.

> 함수형 컴포넌트 내에서 일반 변수를 선언하여 사용할 경우

리렌더링 시, 함수형 컴포넌트는 일반 자바스크립트 함수와 마찬가지로 호출될 때마다 함수 내부에 정의된 로컬 변수들을 초기화한다. **즉 렌더링 될 때 마다 변수 값이 초기화되는 것이다.** 이는 컴포넌트 고유의 값으로 사용하기에는 한계가 있어 보인다.

> useRef로 선언하여 사용할 경우

`useRef`로 만들어진 객체는 React가 만든 전역 저장소에 저장되므로, 함수가 아무리 재호출되더라도 **마지막으로 업데이트한 current 값이 유지된다.**

## ref를 유용하게 사용할 수 있는 경우

- state의 이전 값
- DOM 요소와 관련된 이벤트(focus 등)
- 고유한 id 값

리렌더링이 일어나지 않으면서 고유한 값을 사용해야 할 때 유용하다.

> `스크롤`을 예시로 들어보자.

우리가 채팅을 입력하며 함수 컴포넌트를 재호출하게 될 때, 스크롤을 움직이면 스크롤의 state 값이 변하고 이로 인해 계속해서 리렌더링이 일어나게 된다.
-> 이를 `useRef` 를 사용하여 동일한 참조값을 유지한다면 스크롤의 상태에 관계없이 리렌더링은 일어나지 않을 것이다.

## 정리
> useRef Hook의 여러가지 역할

- DOM 을 선택하는 용도
- 컴포넌트 안에서 조회 및 수정 할 수 있는 변수를 관리 (클래스의 instance 속성과 유사)
    - useRef 로 관리하는 변수는 값이 바뀌어도 컴포넌트 리렌더링 X
    - 값 수정시 .current 값을 수정, 조회시 .current 를 조회